<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>滑动验证</title>
        <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.10.0/jquery.min.js"></script>
        <style>
            .verify-bar-area {
                position: relative;
                width: 300px;
                height: 44px;
                line-height: 44px;
                background: #e8e8e8;
                text-align: center;
            }
            .verify-bar-area .verify-default-bar {
                position: absolute;
                top: 0;
                left: 0;
                width: 0;
                height: 100%;
                background: #7ac23c;
            }
            .verify-bar-area .verify-move-block {
                position: absolute;
                top: -1px;
                left: -1px;
                z-index: 2;
                width: 44px;
                height: 44px;
                line-height: 44px;
                background: #ffffff;
                border: 1px solid #ccc;
                color: #737383;
                cursor: move;
            }
            .verify-bar-area .verify-icon {
                display: block;
                font-size: 18px;
                font-style: normal;
            }
            .verify-bar-area .verify-left-bar {
                position: absolute;
                top: 0;
                left: 0;
                z-index: 1;
                width: 100%;
                height: 100%;
            }
            .verify-bar-area .verify-msg {
                display: inline-block;
                width: 100%;
                height: 100%;
                line-height: 44px;
                font-size: 12px;
                color: #fff;
                background: -webkit-gradient(
                    linear,
                    left top,
                    right top,
                    color-stop(0, #4d4d4d),
                    color-stop(0.4, #4d4d4d),
                    color-stop(0.5, #fff),
                    color-stop(0.6, #4d4d4d),
                    color-stop(1, #4d4d4d)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                -webkit-animation: slidetounlock 3s infinite;
                -webkit-text-size-adjust: none;
            }
            @-webkit-keyframes slidetounlock {
                0% {
                    background-position: -200px 0;
                }
                100% {
                    background-position: 200px 0;
                }
            }

            @font-face {
                font-family: iconfont;
                src: url(data:application/x-font-woff;charset=utf-8;base64,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)
                        format("woff");
            }
            .iconfont {
                font-family: iconfont !important;
                font-size: 16px;
                font-style: normal;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            .icon-check:before {
                content: "\e645";
            }
            .icon-close:before {
                content: "\e646";
            }
            .icon-right:before {
                content: "\e6a3";
            }
        </style>
        <style>
            #slider {
                margin: 30px;
                width: 350px;
                height: 44px;
            }
        </style>
    </head>
    <body>
        <div id="slider"></div>

        <script>
            ;(function($, window, document) {
                window.slideVerify = {
                    $element: '',
                    defaults: {
                        vOffset: 3,  // 误差
                        barSize: {  // 滑动条大小
                            width: '340px',
                            height: '44px'
                        },
                        msg: {  // 提示信息
                            default: '拖动滑块至最右端进行验证',
                            success: '验证成功'
                        },
                        ready: function() {},
                        success: function() {},
                        error: function() {}
                    },
                    options: {},
                    init: function(ele, opt) {
                        var that = this;
                        that.$element = ele;
                        that.options = $.extend({}, that.defaults, opt);
                        that.loadDom();
                        that.options.ready();
                        that.$element[0].onselectstart = document.body.ondrag = function() {
                            return false;
                        };
                        that.htmlDoms.move_block.on('touchstart', function(e) {
                            that.start(e);
                        });
                        that.htmlDoms.move_block.on('mousedown', function(e) {
                            that.start(e);
                        });
                        window.addEventListener("touchmove", function(e) {
                            that.move(e);
                        });
                        window.addEventListener("mousemove", function(e) {
                            that.move(e);
                        });
                        window.addEventListener("touchend", function() {
                            that.end();
                        });
                        window.addEventListener("mouseup", function() {
                            that.end();
                        });
                    },
                    loadDom: function() {
                        var panelHtml = '';
                        panelHtml += '<div class="verify-bar-area">'+
                                        '<div class="verify-default-bar"></div>'+
                                        '<div class="verify-move-block">'+
                                            '<i class="verify-icon iconfont icon-right"></i>'+
                                        '</div>'+
                                        '<div class="verify-left-bar">'+
                                            '<span class="verify-msg">'+this.options.msg.default+'</span>'+
                                        '</div>'+
                                    ' </div>';
                        this.$element.append(panelHtml);
                        this.htmlDoms = {
                            bar_area: this.$element.find('.verify-bar-area'),
                            default_bar: this.$element.find('.verify-default-bar'),
                            move_block: this.$element.find('.verify-move-block'),
                            icon: this.$element.find('.verify-icon'),
                            left_bar: this.$element.find('.verify-left-bar'),
                            msg: this.$element.find('.verify-msg')
                        };
                        this.status = false;
                        this.htmlDoms.bar_area.css({
                            'width': this.options.barSize.width,
                            'height': this.options.barSize.height,
                            'line-height': this.options.barSize.height
                        });
                        this.htmlDoms.default_bar.css({
                            'width': 0
                        });
                        this.htmlDoms.move_block.css({
                            'width': this.options.barSize.height,
                            'height': this.options.barSize.height,
                            'left': 0
                        });
                        this.htmlDoms.left_bar.css({
                            'width': this.options.barSize.width,
                            'height': this.options.barSize.height
                        });
                        this.htmlDoms.msg.css({
                            'line-height': this.options.barSize.height
                        });
                    },
                    start: function(e) {
                        e.stopPropagation();
                        this.status = true;
                    },
                    move: function(e) {
                        if(this.status) {
                            var x;
                            if(!e.touches) {
                                x = e.clientX;
                            } else {
                                x = e.touches[0].pageX;
                            }
                            var bar_area_left = this.getLeft(this.htmlDoms.bar_area[0]);
                            var move_block_left = x - bar_area_left;
                            var block_width = parseInt(parseInt(this.options.barSize.height) / 2);
                            var max_width = this.htmlDoms.bar_area[0].offsetWidth - block_width + parseInt(this.options.vOffset);
                            if (move_block_left >= max_width) {
                                move_block_left = max_width;
                            }
                            if (move_block_left <= 0) {
                                move_block_left = block_width;
                            }
                            this.htmlDoms.default_bar.css('width', move_block_left - block_width + "px");
                            this.htmlDoms.move_block.css('left', move_block_left - block_width + "px");
                        }
                    },
                    end: function() {
                        var that = this;
                        if (this.status) {
                            if (parseInt(this.htmlDoms.move_block.css('left')) >= (parseInt(this.options.barSize.width) - parseInt(this.options.barSize.height) - parseInt(this.options.vOffset))) {
                                this.htmlDoms.icon.css({
                                    'color': '#fff',
                                    'background': '#7ac23c'
                                });
                                this.htmlDoms.move_block.css({
                                    'border-color': '#7ac23c'
                                });
                                this.htmlDoms.icon.removeClass('icon-right');
                                this.htmlDoms.icon.addClass('icon-check');
                                this.htmlDoms.move_block.unbind('mousedown');
                                this.htmlDoms.move_block.unbind('touchstart');
                                this.htmlDoms.msg.text(this.options.msg.success);
                                this.options.success();
                            } else {
                                setTimeout(function() {
                                    that.htmlDoms.default_bar.animate({
                                        'width': 0
                                    }, 'fast');
                                    that.htmlDoms.move_block.animate({
                                        'left': 0
                                    }, 'fast');
                                    that.options.error();
                                }, 400);
                            }
                            this.status = false;
                        }
                    },
                    getLeft: function(node) {
                        var left = $(node).offset().left;
                        return left;
                    }
                };
            })(jQuery, window, document);
        </script>
        <script>
            slideVerify.init($("#slider"), {
                ready: function () {
                    console.log("---ready---");
                },
                success: function () {
                    console.log("验证成功");
                },
                error: function () {
                    console.log("验证失败");
                },
            });
        </script>
    </body>
</html>
